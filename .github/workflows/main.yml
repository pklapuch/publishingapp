name: GitHub Actions Demo
run-name: ${{ github.actor }} is testing out GitHub Actions üöÄ
on: 
  workflow_dispatch:
  
jobs:
  Consume-Pending-Request:
    runs-on: macos-latest
    steps:
      - run: echo "üéâ Triggered by a ${{ github.event_name }} event."

      - name: "Build and Export IPA"
        run: |
          echo "This is a fake IPA (before resigning)" > ipa_fake.txt

      - name: Install JSON Parser (JQ)
        run: |
          brew install jq

      - name: Download SDK
        run: |
          UTILITY_URL="https://utilitiy-tools.s3.us-east-2.amazonaws.com/resignutility"
          curl -O $UTILITY_URL
          chmod 777 resignutility

      - name: Get Pending Request (if any)
        run: |
          RESULT=$(./resignutility getNext -baseURL https://esuiymlk0l.execute-api.us-east-2.amazonaws.com/dev/publishing -ipaPath ipa_fake.txt)
          if [ $RESULT == 1 ]; then
            json=$(cat config.json)
            echo "$json"
          fi
          
      
      - run: echo "üçè This job's status is ${{ job.status }}."
